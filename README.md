![BrowserStack Status](https://www.browserstack.com/automate/badge.svg?badge_key=NTRtOFlhYTlGbHpSMFA0b21iREIxZTZwQWRHK1AyWlQxWHAzQzJRVXhvND0tLXBQZC9XZ3ltcC9pVjVpT2lxTUg1Znc9PQ==--8cc11b84cc9a7dd51e6dcccafdfb465f13bbd75b)

# formicido
Site monitor like an ant.

## Getting started
Formicido is a library which contains an express.js web application which can be used for configuring your scripts. Here's a quick-start guide to running the configuration app:

index.js:
```javascript
const formicido = require( "formicido" );
const config = {

    port: 8888,
    repo: { root: __dirname + "/data" }

};
formicido( config ).then( () =>

    console.log( `Configuration fixture is running at: http://localhost:${config.port}` )

);
```
create a folder for data, install formicido, then run:
```bash
mkdir data
npm install formicido --save
node index

Running { port: 8888,
  repo: { root: '/home/goofballLogic/src/my-project/monitor/data' } }
Configuration fixture is running at: http://localhost:8888

```

## Design-time requirements

Although no such requirements exist when running the monitoring tool, certain requirements are imposed in order to use the configuration interface:

* Your site must be capable of running within an IFRAME
* You must run the Formicido javascript agent in your application, so that it can carry out browser-like actions (such as navigation or clicking)

### Running the Formicido javascript agent

There are two ways you may consider to run the agent within your application. The simplest way may be to add the following SCRIPT element to the HEAD of your web-site:
```html
<!-- The design-time agent for Formicido -->
<SCRIPT src="http://localhost:8888/agent"></SCRIPT>
```

Another way to accomplish the same effect is to inject this script using a browser extension such as Tampermonkey. This process is explained here: https://github.com/goofballLogic/formicido/wiki/Injecting-the-agent-script-into-a-web-page-using-a-browser-extension

## Creating your first script

Formicido scripts consist of one or more _paths_, each of which consist of one or more configured _steps_. A step is a piece of parameterisable code which can be configured and combined with other configured steps to make up a named _path_.

### 1. Create a "Navigate" step
You will usually start your paths with a "Navigate" step - moving the browser to the start point of the user journey you wish to monitor.

_Note_: At the bottom of the page (perhaps in the middle of your screen), you will notice an iframe which you can navigate using the URL input and the GO button. This lets you verify you have the correct URL.

Try entering https://www.w3schools.com/html/html_examples.asp and pressing the GO button.

1. Click on "Paths"
1. Click "Create" (note that your path is automatically assigned a notional ID)
1. Name your path "My first path" and Save it so you can recognise it later
1. Choose "Navigate" from the "Add a new step" drop-down and click "Configure..."
1. Note that you are now configuring a Navigate step for your "My first path" path
1. Configure your step with the correct URL (for example you could copy the URL out of the iframe control). 
1. Click the "Run" button to test your configuration. You should see a snippet of Javascript generated by the Navigate step, and the iframe should navigate to the site in question.
1. Once you are happy that the configuration is correct. Click the Save step button.

### 2. Add a "Click then wait for new location" step
This step will attempt to click something on the page loaded in your previous step, and then wait for the iframe to navigate to a new location.

1. Choose "Click then wait for new location" and click "Configure..."
1. Navigate the iframe to the location specified in your previous step.
1. Find a link and view it in development tools so you can determine a valid query-selector for locating this element. For example, ".w3-navbar a[title='JavaScript Tutorial']"



## Metrics



## Testing
Thanks to the good people at BrowserStack, this application is being automatically tested cross-browser. This means that we can drive selenium tests running in Travis as part of our CI build. We use Browserstack selenium bindings along with Cucumber.
[More about testing with Selenium](https://github.com/goofballLogic/formicido/wiki/Testing)
