{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 0b075254d524fc0029c7","webpack:///./src/client/app.js","webpack:///./src/client/browser-enhancements.js","webpack:///./src/client/browser-polyfills.js","webpack:///./src/client/emitters/browser/agent.js","webpack:///./src/client/enrichers/browser/ajax-form-submit.js","webpack:///./src/client/enrichers/browser/embedded-browser-widget.js","webpack:///./src/client/enrichers/browser/path-page.js","webpack:///./src/client/enrichers/browser/runners.js","webpack:///./src/client/enrichers/browser/script-run-page.js","webpack:///./src/client/enrichers/browser/step-page.js","webpack:///./src/client/listeners/browser/agent.js","webpack:///./src/client/listeners/browser/metrics-sink.js","webpack:///./src/client/listeners/browser/notifications.js","webpack:///./src/client/browser.js","webpack:///./src/client/enrichers/metrics-generator.js","webpack:///./src/client/enrichers/path-runner.js","webpack:///./src/client/enrichers/script-runner.js","webpack:///./src/client/enrichers/step-runner.js","webpack:///./src/client/promise-timeout.js","webpack:///./~/events/events.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","uuid","replace","r","Math","random","toString","app","ns","options","debug","bus","DebuggableEventEmitter","notify","message","emit","error","_stepRunner2","_pathRunner2","_scriptRunner2","_metricsGenerator2","_createClass","defineProperties","target","props","length","descriptor","key","protoProps","staticProps","_get","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","_events","_events2","_stepRunner","_pathRunner","_scriptRunner","_metricsGenerator","_EventEmitter","this","_this","_len","arguments","args","Array","_key","console","log","apply","_len2","_key2","document","addEventListener","e","classList","contains","querySelectorAll","getAttribute","forEach","ele","innerHTML","tagName","form","closest","originalAction","action","setTimeout","window","Element","matches","ownerDocument","el","item","parentElement","data","type","received","origin","ajaxFormSubmit","ajaxSubmit","doc","slice","elements","field","push","url","location","method","body","JSON","stringify","headers","Accept","Content-Type","fetch","then","response","ok","indexOf","href","json","text","Error","status","catch","preventDefault","embeddedBrowser","id","stopPropagation","querySelector","src","on","waiter","isActive","frame","removeEventListener","clearTimeout","giveup","err","setAttribute","detail","paths","script","pathScripts","transcript","pathIds","map","pathId","path","pathElement","createElement","appendChild","nextIterationURL","checked","add","steps","stepScripts","x","description","errorSteps","_ref","isError","scriptOutcome","outcome","errors","concat","join","remove","pathContext","context","step","stepElement","contentWindow","postMessage","metrics","navigator","sendBeacon","displayNotification","infoBlock","timeBlock","messageBlock","Date","toLocaleDateString","className","displayErrorNotification","stack","_app","_app2","_agent","_agent2","_ajaxFormSubmit","_ajaxFormSubmit2","_embeddedBrowserWidget","_embeddedBrowserWidget2","_runners","_runners2","_stepPage","_stepPage2","_pathPage","_pathPage2","_scriptRunPage","_scriptRunPage2","_agent3","_agent4","_notifications","_notifications2","_metricsSink","_metricsSink2","formicido","replaceErrors","getOwnPropertyNames","recordMetric","parse","_extends","assign","source","runPath","nextStep","isAborted","runId","aborted","errStack","bookmark","once","end","now","compensation","compensations","unattempted","filter","compensationAttempts","continuation","compensationContext","pathDetail","compensationPathDetail","start","_ref2","_ref3","nextPath","removeListener","pathComplete","_detail$path","errorPaths","scriptId","runner","buildRemoteListener","cid","resolve","reject","output","isSuccess","scrapeJS","maybeFunction","functionScraper","exec","remote","js","timeout","listener","_promiseTimeout2","buildPollTask","testScript","interval","timeoutTest","pollTask","result","poll","isTimedOut","navigateTo","Promise","constants","stepId","parameterHash","functionParameterNames","keys","functionParameterValues","func","maybeErr","_promiseTimeout","promiseTimeout","promise","callback","constructionStack","deactivate","timedOut","EventEmitter","_maxListeners","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","isNaN","er","handler","len","listeners","addListener","newListener","warned","trace","g","fired","list","position","splice","removeAllListeners","listenerCount","evlistener","emitter"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 13);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _events = __webpack_require__(19);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _stepRunner = __webpack_require__(17);\n\nvar _stepRunner2 = _interopRequireDefault(_stepRunner);\n\nvar _pathRunner = __webpack_require__(15);\n\nvar _pathRunner2 = _interopRequireDefault(_pathRunner);\n\nvar _scriptRunner = __webpack_require__(16);\n\nvar _scriptRunner2 = _interopRequireDefault(_scriptRunner);\n\nvar _metricsGenerator = __webpack_require__(14);\n\nvar _metricsGenerator2 = _interopRequireDefault(_metricsGenerator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction uuid() {\n\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = Math.random() * 16 | 0,\n            v = c == 'x' ? r : r & 0x3 | 0x8;return v.toString(16);\n    });\n}\n\nvar DebuggableEventEmitter = function (_EventEmitter) {\n    _inherits(DebuggableEventEmitter, _EventEmitter);\n\n    function DebuggableEventEmitter(options) {\n        _classCallCheck(this, DebuggableEventEmitter);\n\n        var _this = _possibleConstructorReturn(this, (DebuggableEventEmitter.__proto__ || Object.getPrototypeOf(DebuggableEventEmitter)).call(this));\n\n        _this.options = options;\n\n        return _this;\n    }\n\n    _createClass(DebuggableEventEmitter, [{\n        key: \"emit\",\n        value: function emit() {\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            if (this.options.debug) {\n                console.log(\"Emit\", args);\n            }\n            return _get(DebuggableEventEmitter.prototype.__proto__ || Object.getPrototypeOf(DebuggableEventEmitter.prototype), \"emit\", this).apply(this, args);\n        }\n    }, {\n        key: \"on\",\n        value: function on() {\n            for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                args[_key2] = arguments[_key2];\n            }\n\n            if (this.options.debug) {\n                console.log(\"On\", args);\n            }\n            return _get(DebuggableEventEmitter.prototype.__proto__ || Object.getPrototypeOf(DebuggableEventEmitter.prototype), \"on\", this).apply(this, args);\n        }\n    }]);\n\n    return DebuggableEventEmitter;\n}(_events2.default);\n\nfunction app(ns) {\n\n    var options = ns.options = { debug: false };\n    var bus = ns.bus = new DebuggableEventEmitter(ns.options);\n\n    ns.uuid = uuid;\n    ns.notify = function (message) {\n        return bus.emit(\"info-message\", message);\n    };\n    ns.debug = function (message) {\n        return options.debug ? bus.emit(\"debug-message\", message) : false;\n    };\n    ns.error = function (message) {\n        return bus.emit(\"error-message\", message);\n    };\n\n    (0, _stepRunner2.default)(ns);\n    (0, _pathRunner2.default)(ns);\n    (0, _scriptRunner2.default)(ns);\n    (0, _metricsGenerator2.default)(ns);\n}\nexports.default = app;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\ndocument.addEventListener(\"click\", function clearButton(e) {\n\n    if (!(e.target && e.target.classList.contains(\"clear-button\"))) {\n        return;\n    }\n    var elements = document.querySelectorAll(e.target.getAttribute(\"data-selectors\"));\n    elements.forEach(function (ele) {\n\n        if (ele.innerHTML) {\n            ele.innerHTML = \"\";\n        }\n        if (ele.value) {\n            ele.value = \"\";\n        }\n    });\n});\n\ndocument.addEventListener(\"click\", function redirectFormSubmission(e) {\n\n    if (e.target.tagName !== \"BUTTON\") {\n        return;\n    }\n    if (!e.target.classList.contains(\"redirect-form\")) {\n        return;\n    }\n    var form = e.target.closest(\"form\");\n    if (!form) {\n        return;\n    }\n    var originalAction = form.action;\n    form.action = e.target.value;\n    setTimeout(function () {\n\n        form.action = originalAction;\n    }, 100);\n    return true;\n});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill\nif (window.Element && !window.Element.prototype.closest) {\n    window.Element.prototype.closest = function (s) {\n        var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n            i,\n            el = this;\n        do {\n            i = matches.length;\n            while (--i >= 0 && matches.item(i) !== el) {};\n        } while (i < 0 && (el = el.parentElement));\n        return el;\n    };\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n\n    window.addEventListener(\"message\", function (e) {\n\n        if (!(e.data && e.data.args && e.data.type === \"agent-response\")) {\n            return;\n        }\n        var received = { origin: e.origin, data: e.data };\n        bus.emit(\"agent-response\", received);\n    });\n};\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = ajaxFormSubmit;\nfunction ajaxFormSubmit(ns) {\n    var bus = ns.bus;\n\n\n    function ajaxSubmit(form) {\n\n        var doc = {};\n        [].slice.call(form.elements, 0).forEach(function (field) {\n\n            var name = field.name;\n            if (name) {\n\n                var values = doc[name] = doc[name] || [];\n                values.push(field.value);\n            }\n        });\n        var url = form.action || window.location.toString();\n        var options = {\n\n            method: \"POST\",\n            body: JSON.stringify(doc),\n            headers: { \"Accept\": \"application/json\", \"Content-Type\": \"application/json\" }\n\n        };\n        window.fetch(url, options).then(function (response) {\n\n            if (response.ok) {\n\n                var redirectedToHTML = !!~response.headers.get(\"content-type\").indexOf(\"text/html\");\n                if (redirectedToHTML) {\n\n                    window.location.href = response.url;\n                } else {\n\n                    return response.json().then(function (json) {\n                        return bus.emit(\"fetch-result\", json);\n                    });\n                }\n            } else {\n\n                return response.text().then(function (text) {\n\n                    throw new Error(\"Fetch failed with \" + response.status + \": \" + text);\n                }, function (e) {\n\n                    throw new Error(\"Fetch failed with \" + response.status + \": \" + e.message);\n                });\n            }\n        }).catch(function (e) {\n            return bus.emit(\"error-message\", e.message);\n        });\n    }\n\n    document.addEventListener(\"submit\", function (e) {\n\n        if (!e.target.classList.contains(\"via-ajax\")) {\n            return;\n        }\n        e.preventDefault();\n        ajaxSubmit(e.target);\n    });\n}\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = embeddedBrowser;\nfunction embeddedBrowser(ns) {\n    var bus = ns.bus;\n\n\n    document.addEventListener(\"submit\", function (e) {\n\n        if (e.target.id === \"embedded-browser-controls\") {\n\n            e.preventDefault();\n            e.stopPropagation();\n            var url = e.target.location.value;\n            document.querySelector(\"#embedded-browser\").src = url;\n        }\n    });\n\n    bus.on(\"navigate-to\", function (url) {\n\n        var frame = document.querySelector(\"#embedded-browser\");\n        var isActive = true;\n        var giveup = setTimeout(function () {\n\n            if (!isActive) {\n                return;\n            }\n            isActive = false;\n            frame.removeEventListener(\"load\", waiter);\n            bus.emit(\"navigate-to-complete\", { url: url, err: new Error(\"Timed out\") });\n        }, 10000);\n\n        function waiter() {\n\n            if (!isActive) {\n                return;\n            }\n            frame.removeEventListener('load', waiter);\n            clearTimeout(giveup);\n            bus.emit(\"navigate-to-complete\", { url: url });\n        }\n        frame.addEventListener('load', waiter);\n        frame.setAttribute(\"src\", url);\n    });\n}\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n    window.addEventListener(\"DOMContentLoaded\", function () {\n\n        if (!document.body.classList.contains(\"path-page\")) {\n            return;\n        }\n        bus.on(\"fetch-result\", function (detail) {\n            return bus.emit(\"run-path\", detail);\n        });\n    });\n};\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus,\n        error = ns.error;\n\n\n    var paths = void 0;\n    bus.on(\"run-script\", function (script) {\n        var pathScripts = script.pathScripts;\n\n        var transcript = document.querySelector(\".script-transcript\");\n        paths = pathScripts.pathIds.map(function (pathId) {\n\n            var path = pathScripts.paths[pathId];\n            var pathElement = document.createElement(\"li\");\n            pathElement.innerHTML = path.name;\n            transcript.appendChild(pathElement);\n            return pathElement;\n        });\n    });\n\n    bus.on(\"script-complete\", function (detail) {\n        var nextIterationURL = detail.script.nextIterationURL;\n\n        var stopper = document.querySelector(\"#stop\");\n        if (!stopper.checked) {\n\n            window.location.replace(nextIterationURL);\n        } else {\n\n            document.body.classList.add(\"paused\");\n        }\n    });\n\n    var steps = void 0;\n    bus.on(\"run-path\", function (detail) {\n        var pathId = detail.pathId,\n            paths = detail.paths;\n        var stepScripts = paths[pathId].stepScripts;\n\n        var transcript = document.querySelector(\".path-transcript\");\n        var outcome = document.querySelector(\".path-outcome\") || {};\n        outcome.innerHTML = \"Running...\";\n        transcript.innerHTML = \"\";\n        steps = stepScripts.map(function (x) {\n\n            var s = document.createElement(\"li\");\n            s.innerHTML = x.description;\n            transcript.appendChild(s);\n            return s;\n        });\n    });\n\n    bus.on(\"path-complete\", function (detail) {\n        var errorSteps = detail.path.errorSteps;\n\n        var _ref = detail.script || {},\n            path = _ref.path;\n\n        var isError = errorSteps && errorSteps.length;\n        var scriptOutcome = document.querySelector(\".script-outcome\") || {};\n        var outcome = document.querySelector(\".path-outcome\") || {};\n        var errors = (errorSteps || []).map(function (x) {\n            return x.err;\n        });\n        outcome.innerHTML = [\"Complete.\"].concat(errors).join(\"<br />\");\n\n        if (isError) {\n            error(errors.join(\"<br />\"));\n        }\n        if (path && paths && paths.length) {\n\n            var pathElement = paths[path - 1];\n            pathElement.classList.remove(\"running\");\n            scriptOutcome.innerHTML = \"Complete.\";\n            pathElement.classList.add(isError ? \"error\" : \"success\");\n        }\n    });\n\n    bus.on(\"run-step\", function (detail) {\n\n        var outcome = document.querySelector(\".step-outcome\") || {};\n        outcome.innerHTML = \"Running...\";\n        if (steps && steps.length) {\n\n            var pathContext = detail.context.path;\n            steps[pathContext.step - 1].classList.add(\"running\");\n        }\n    });\n\n    bus.on(\"step-complete\", function (detail) {\n        var err = detail.step.err;\n\n        var step = detail.path ? detail.path.step : \"\";\n        var outcome = document.querySelector(\".step-outcome\") || {};\n        if (steps && steps.length) {\n\n            var stepElement = steps[step - 1];\n            stepElement.classList.remove(\"running\");\n            if (err) {\n\n                stepElement.classList.add(\"error\");\n                outcome.innerHTML += \"Step \" + step + \": \" + err + \"\\n\";\n            } else {\n\n                stepElement.classList.add(\"success\");\n            }\n        } else {\n\n            outcome.innerHTML = \"Complete. \" + (err || \"\");\n        }\n    });\n};\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n    bus.on(\"initiate-script\", function (script) {\n        return bus.emit(\"run-script\", script);\n    });\n};\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n\n    window.addEventListener(\"DOMContentLoaded\", function () {\n\n        if (!document.body.classList.contains(\"step-page\")) {\n            return;\n        }\n        ns.options.debug = true;\n\n        bus.on(\"fetch-result\", function (detail) {\n\n            document.querySelector(\"#code\").innerHTML = detail.script;\n            bus.emit(\"run-step\", detail);\n        });\n    });\n};\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus,\n        error = ns.error;\n\n    bus.on(\"agent-request\", function (detail) {\n\n        var frame = document.querySelector(\"#embedded-browser\");\n        if (!frame) {\n            error(\"No embedded browser found\");\n        }\n        frame.contentWindow.postMessage(detail, \"*\");\n    });\n};\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n    bus.on(\"metrics\", function (metrics) {\n\n        window.navigator.sendBeacon(\"/metrics\", metrics);\n    });\n};\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n    bus.on(\"error-message\", displayErrorNotification);\n    bus.on(\"info-message\", displayNotification);\n    bus.on(\"debug-message\", displayNotification);\n};\n\nfunction displayNotification(message, isError) {\n\n    var infoBlock = document.createElement(\"li\");\n    var timeBlock = document.createElement(\"time\");\n    var messageBlock = document.createElement(\"div\");\n\n    messageBlock.innerHTML = message;\n    timeBlock.innerHTML = new Date().toLocaleDateString();\n    infoBlock.className = isError ? \"error\" : \"\";\n    infoBlock.appendChild(timeBlock);\n    infoBlock.appendChild(messageBlock);\n    infoBlock.classList.add(\"goes\");\n    document.querySelector(\".infos\").appendChild(infoBlock);\n    setTimeout(function () {\n\n        infoBlock.classList.add(\"going\");\n        setTimeout(function () {\n            return infoBlock.remove();\n        }, 500);\n    }, 5000);\n}\n\nfunction displayErrorNotification(message) {\n\n    displayNotification(message.stack || message, true);\n}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(2);\n\n__webpack_require__(1);\n\nvar _app = __webpack_require__(0);\n\nvar _app2 = _interopRequireDefault(_app);\n\nvar _agent = __webpack_require__(3);\n\nvar _agent2 = _interopRequireDefault(_agent);\n\nvar _ajaxFormSubmit = __webpack_require__(4);\n\nvar _ajaxFormSubmit2 = _interopRequireDefault(_ajaxFormSubmit);\n\nvar _embeddedBrowserWidget = __webpack_require__(5);\n\nvar _embeddedBrowserWidget2 = _interopRequireDefault(_embeddedBrowserWidget);\n\nvar _runners = __webpack_require__(7);\n\nvar _runners2 = _interopRequireDefault(_runners);\n\nvar _stepPage = __webpack_require__(9);\n\nvar _stepPage2 = _interopRequireDefault(_stepPage);\n\nvar _pathPage = __webpack_require__(6);\n\nvar _pathPage2 = _interopRequireDefault(_pathPage);\n\nvar _scriptRunPage = __webpack_require__(8);\n\nvar _scriptRunPage2 = _interopRequireDefault(_scriptRunPage);\n\nvar _agent3 = __webpack_require__(10);\n\nvar _agent4 = _interopRequireDefault(_agent3);\n\nvar _notifications = __webpack_require__(12);\n\nvar _notifications2 = _interopRequireDefault(_notifications);\n\nvar _metricsSink = __webpack_require__(11);\n\nvar _metricsSink2 = _interopRequireDefault(_metricsSink);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ns = window.formicido = window.formicido || {};\n\n[_app2.default, // must be first\n\n_notifications2.default, // user-display notifications\n_metricsSink2.default, // relay metrics to the server\n\n_ajaxFormSubmit2.default, // ajaxify form submission\n\n_agent2.default, // marshall messages from agent\n_agent4.default, // marshall messages to agent\n\n_embeddedBrowserWidget2.default, // react to the embedded (iframe) browser control\n_runners2.default, // log the results of running stuff\n\n_stepPage2.default, _pathPage2.default, _scriptRunPage2.default].forEach(function (module) {\n    return module(ns);\n});\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus;\n\n    // thanks: http://stackoverflow.com/a/18391400/275501\n\n    function replaceErrors(key, value) {\n\n        if (value instanceof Error) {\n            var error = {};\n\n            Object.getOwnPropertyNames(value).forEach(function (key) {\n                error[key] = value[key];\n            });\n            return error;\n        }\n        return value;\n    }\n\n    var recordMetric = function recordMetric(type) {\n        return function (detail) {\n\n            detail = JSON.parse(JSON.stringify(detail, replaceErrors));\n            bus.emit(\"metrics\", JSON.stringify({ type: type, detail: detail }));\n        };\n    };\n\n    bus.on(\"step-complete\", recordMetric(\"step\"));\n    bus.on(\"path-complete\", recordMetric(\"path\"));\n    bus.on(\"script-complete\", recordMetric(\"script\"));\n};\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = function (ns) {\n    var bus = ns.bus,\n        notify = ns.notify;\n\n    var aborted = {};\n    var instance = Math.random();\n\n    /*\n        runId: the id of the current run (e.g. a script run)\n        stepScripts: the steps to run for this path\n        compensations: the ids of paths to attempt to compensate for a failure (such as session timed out)\n        pathDetail: id of the path to run, and a dictionary of path definitions\n    */\n    function runPath(_ref) {\n        var runId = _ref.runId,\n            stepScripts = _ref.stepScripts,\n            compensations = _ref.compensations,\n            pathDetail = _ref.pathDetail;\n        var context = pathDetail.context,\n            continuation = pathDetail.continuation;\n        var path = context.path;\n\n\n        var compensationAttempts = pathDetail.compensations = pathDetail.compensations || {};\n\n        var bookmark = 0;\n\n        // run a single step within the current path\n        function nextStep(detail) {\n\n            var isAborted = runId in aborted;\n            if (isAborted) {\n                bus.emit(\"run-path-aborted\", context);\n            }\n            var err = detail ? detail.step.err : null;\n            if (err) {\n\n                // an error occurred - record diagnostics\n                path.errorSteps = path.errorSteps || [];\n                detail.step.errStack = err.stack;\n                path.errorSteps.push(detail.step);\n            }\n            if (!err && bookmark < stepScripts.length && !isAborted) {\n\n                // no error and step completed, so we can move on to the next one\n                bus.once(\"step-complete\", nextStep);\n                path.step = bookmark + 1;\n                var message = _extends({ context: context }, stepScripts[bookmark]);\n                bookmark++;\n                bus.emit(\"run-step\", message);\n            } else {\n\n                path.end = Date.now();\n                var compensation = null;\n                if (err && compensations) {\n\n                    // can we compensate for this error?\n                    var unattempted = compensations.filter(function (x) {\n                        return !(x in compensationAttempts);\n                    });\n                    compensation = unattempted[0];\n                }\n                if (compensation) {\n\n                    notify(\"Attempting compensation: \" + compensation);\n                    var _continuation = function _continuation(compensationContext) {\n\n                        compensationAttempts[compensation] = JSON.parse(JSON.stringify(compensationContext));\n                        bus.emit(\"run-path\", pathDetail);\n                    };\n                    var compensationPathDetail = Object.assign({}, pathDetail, { continuation: _continuation, pathId: compensation });\n                    bus.emit(\"run-path\", compensationPathDetail);\n                } else {\n\n                    if (continuation) {\n\n                        // this path was instructed to invoke a continuation upon completion (e.g. because it was a compensation path)\n                        notify(\"Path with continuation run complete\");\n                        continuation(context);\n                    } else {\n\n                        notify(\"Path run complete\");\n                        delete context.step;\n                        context.path.compensations = pathDetail.compensations;\n                        bus.emit(\"path-complete\", context);\n                    }\n                }\n            }\n        }\n        path.start = Date.now();\n        nextStep();\n    }\n\n    bus.on(\"abort-run\", function (detail) {\n\n        notify(\"path-runner \" + instance + \" received abort-run \" + detail);\n        aborted[detail.id] = Date.now();\n        setTimeout(function () {\n            return delete aborted[detail.id];\n        }, 60000);\n    });\n\n    bus.on(\"run-path\", function (pathDetail) {\n        var pathId = pathDetail.pathId,\n            paths = pathDetail.paths;\n\n        var _ref2 = paths[pathId] || {},\n            stepScripts = _ref2.stepScripts,\n            name = _ref2.name,\n            compensations = _ref2.compensations;\n\n        if (!(stepScripts && stepScripts.length)) {\n\n            notify(\"No steps specified\");\n        }\n\n        var context = pathDetail.context = pathDetail.context || {};\n\n        var _ref3 = context.script || {},\n            runId = _ref3.runId;\n\n        context.path = { name: name, pathId: pathId };\n        runPath({\n\n            compensations: compensations,\n            pathDetail: pathDetail,\n            runId: runId,\n            stepScripts: stepScripts\n\n        });\n    });\n};\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (ns) {\n    var bus = ns.bus,\n        notify = ns.notify;\n\n    var aborted = {};\n    var instance = Math.random();\n\n    bus.on(\"abort-run\", function (detail) {\n\n        notify(\"script-runner \" + instance + \" received abort-run \" + detail);\n        aborted[detail.id] = Date.now();\n        setTimeout(function () {\n            return delete aborted[detail.id];\n        }, 60000);\n    });\n\n    bus.on(\"run-script\", function (script) {\n\n        var bookmark = 0;\n        var pathScripts = script.pathScripts,\n            nextIterationURL = script.nextIterationURL,\n            runId = script.runId,\n            name = script.name;\n        var pathIds = pathScripts.pathIds,\n            paths = pathScripts.paths;\n\n        var scriptId = script.id;\n        var context = { script: { scriptId: scriptId, name: name, nextIterationURL: nextIterationURL, runId: runId } };\n\n        function nextPath() {\n\n            var isAborted = runId in aborted;\n            if (isAborted) {\n                bus.emit(\"run-script-aborted\", context);\n            }\n            if (bookmark < pathIds.length && !isAborted) {\n\n                context.script.path = bookmark + 1;\n                bus.emit(\"run-path\", { context: context, pathId: pathIds[bookmark], paths: paths });\n                bookmark++;\n            } else {\n\n                bus.removeListener(\"path-complete\", pathComplete);\n                context.script.end = Date.now();\n                delete context.path;\n                bus.emit(\"script-complete\", context);\n                notify(\"Script run complete\");\n            }\n        }\n\n        function pathComplete(detail) {\n            var _detail$path = detail.path,\n                pathId = _detail$path.pathId,\n                start = _detail$path.start,\n                errorSteps = _detail$path.errorSteps;\n\n            if (errorSteps) {\n\n                context.script.errorPaths = context.script.errorPaths || [];\n                context.script.errorPaths.push({ pathId: pathId, start: start, errorSteps: errorSteps });\n            }\n            setTimeout(nextPath, 1000);\n        }\n\n        if (pathIds.length < 1) {\n\n            notify(\"No paths to run\");\n        } else {\n\n            context.script.start = Date.now();\n            bus.on(\"path-complete\", pathComplete);\n            nextPath();\n        }\n    });\n};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = runner;\n\nvar _promiseTimeout = __webpack_require__(18);\n\nvar _promiseTimeout2 = _interopRequireDefault(_promiseTimeout);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction runner(ns) {\n    var bus = ns.bus,\n        uuid = ns.uuid,\n        debug = ns.debug;\n\n\n    function buildRemoteListener(cid, resolve, reject) {\n\n        return function (received) {\n\n            if (!(received && received.data && received.data.cid === cid)) {\n                return;\n            }\n            debug(\"Reply to: \" + cid);\n            var data = received.data;\n            var args = [].concat(data.args || []);\n            var output = args.length === 1 ? args[0] : args;\n            if (data.isSuccess) {\n\n                resolve(output);\n            } else {\n\n                reject(output);\n            }\n        };\n    }\n\n    var functionScraper = /[^{]*{([\\s\\S]*)}$/;\n\n    function scrapeJS(maybeFunction) {\n\n        return typeof maybeFunction === \"function\" ? functionScraper.exec(maybeFunction.toString())[1] : maybeFunction;\n    }\n\n    function remote(js, timeout) {\n\n        js = scrapeJS(js);\n        var cid = uuid();\n        var listener = void 0;\n        return (0, _promiseTimeout2.default)(timeout || 5000, function (resolve, reject) {\n\n            listener = buildRemoteListener(cid, resolve, reject);\n\n            bus.on(\"agent-response\", listener);\n            debug(\"Remoting: \" + cid);\n            bus.emit(\"agent-request\", { cid: cid, js: js });\n        }, function () {\n\n            bus.removeListener(\"agent-response\", listener);\n        });\n    }\n\n    function buildPollTask(testScript, interval, resolve, timeoutTest) {\n\n        var pollTask = function pollTask() {\n            return testScript().catch(function (err) {\n                console.log(err);return false;\n            }).then(function (result) {\n\n                if (result) {\n\n                    resolve();\n                } else {\n\n                    if (!timeoutTest()) {\n\n                        debug(\"Scheduling another poll\");\n                        setTimeout(pollTask, interval);\n                    }\n                }\n            });\n        };\n        return pollTask;\n    }\n\n    function poll(interval, timeout, testScript) {\n\n        var isTimedOut = false;\n        return (0, _promiseTimeout2.default)(timeout, function (resolve, reject) {\n\n            var pollTask = buildPollTask(testScript, interval, resolve, function () {\n                return isTimedOut;\n            });\n            pollTask();\n        }, function () {\n\n            isTimedOut = true;\n        });\n    }\n\n    function navigateTo(url) {\n\n        return new Promise(function (resolve, reject) {\n\n            bus.once(\"navigate-to-complete\", function (detail) {\n                return detail.err ? reject(detail.err) : resolve();\n            });\n            bus.emit(\"navigate-to\", url);\n        });\n    }\n\n    bus.on(\"run-step\", function executeStep(detail) {\n        var id = detail.id,\n            description = detail.description,\n            script = detail.script,\n            args = detail.args,\n            constants = detail.constants;\n\n        var context = detail.context || {};\n        var stepId = id;\n        var parameterHash = Object.assign({ navigateTo: navigateTo, poll: poll, remote: remote }, constants, args);\n        var functionParameterNames = Object.keys(parameterHash);\n        var functionParameterValues = functionParameterNames.map(function (x) {\n            return parameterHash[x];\n        });\n        var func = Function.apply(null, functionParameterNames.concat(script));\n\n        context.step = {\n\n            args: args,\n            description: description,\n            stepId: stepId\n\n        };\n        (0, _promiseTimeout2.default)(10000, function (resolve, reject) {\n\n            context.step.start = Date.now();\n            func.apply(null, functionParameterValues).then(resolve, reject);\n        }, function (maybeErr) {\n\n            context.step.end = Date.now();\n            context.step.err = maybeErr;\n            bus.emit(\"step-complete\", context);\n        });\n    });\n}\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = promiseTimeout;\nfunction promiseTimeout(timeout, promise, callback) {\n\n    var constructionStack = new Error().stack;\n    return new Promise(function (resolve, reject) {\n\n        var isActive = true;\n        function deactivate(err) {\n\n            if (!isActive) {\n                return false;\n            }\n            isActive = false;\n            callback(err);\n            return true;\n        }\n\n        setTimeout(function () {\n\n            var timedOut = new Error(\"Timed out. \" + constructionStack);\n            if (deactivate(timedOut)) {\n\n                reject(timedOut);\n            }\n        }, timeout);\n        promise(function () {\n\n            if (deactivate()) {\n\n                resolve.apply(null, arguments);\n            }\n        }, function (err) {\n\n            if (deactivate(err)) {\n\n                reject.apply(null, arguments);\n            }\n        });\n    });\n}\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0b075254d524fc0029c7","import EventEmitter from \"events\";\nimport stepRunner from \"./enrichers/step-runner\";\nimport pathRunner from \"./enrichers/path-runner\";\nimport scriptRunner from \"./enrichers/script-runner\";\nimport metricsGenerator from \"./enrichers/metrics-generator\";\n\nfunction uuid() {\n\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {var r = Math.random()*16|0,v=c=='x'?r:r&0x3|0x8;return v.toString(16);});\n\n}\n\nclass DebuggableEventEmitter extends EventEmitter {\n\n    constructor( options ) {\n\n        super();\n        this.options = options;\n\n    }\n\n    emit( ...args ) {\n\n        if ( this.options.debug ) { console.log( \"Emit\", args ); }\n        return super.emit.apply( this, args );\n\n    }\n\n    on( ...args ) {\n\n        if ( this.options.debug ) { console.log( \"On\", args ); }\n        return super.on.apply( this, args );\n\n    }\n\n}\n\nfunction app( ns ) {\n\n    const options = ns.options = { debug: false };\n    const bus = ns.bus = new DebuggableEventEmitter( ns.options );\n\n    ns.uuid = uuid;\n    ns.notify = message => bus.emit( \"info-message\", message );\n    ns.debug = message => options.debug ? bus.emit( \"debug-message\", message ) : false;\n    ns.error = message => bus.emit( \"error-message\", message );\n\n    stepRunner( ns );\n    pathRunner( ns );\n    scriptRunner( ns );\n    metricsGenerator( ns );\n\n}\nexport default app;\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/app.js","document.addEventListener( \"click\", function clearButton( e ) {\n\n    if ( !( e.target && e.target.classList.contains( \"clear-button\" ) ) ) { return; }\n    var elements = document.querySelectorAll( e.target.getAttribute( \"data-selectors\" ) );\n    elements.forEach( ele => {\n\n        if ( ele.innerHTML ) { ele.innerHTML = \"\"; }\n        if ( ele.value ) { ele.value = \"\"; }\n\n    } );\n\n} );\n\ndocument.addEventListener( \"click\", function redirectFormSubmission( e ) {\n\n    if ( e.target.tagName !== \"BUTTON\" ) { return; }\n    if ( !e.target.classList.contains( \"redirect-form\" ) ) { return; }\n    var form = e.target.closest( \"form\" );\n    if ( !form ) { return; }\n    var originalAction = form.action;\n    form.action = e.target.value;\n    setTimeout( function() {\n\n        form.action = originalAction;\n\n    }, 100 );\n    return true;\n\n} );\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/browser-enhancements.js","// https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill\nif (window.Element && !window.Element.prototype.closest) {\nwindow.Element.prototype.closest =\n    function(s) {\n        var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n            i,\n            el = this;\n        do {\n            i = matches.length;\n            while (--i >= 0 && matches.item(i) !== el) {};\n        } while ((i < 0) && (el = el.parentElement));\n        return el;\n    };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/browser-polyfills.js","export default function( ns ) {\n\n    const { bus } = ns;\n\n    window.addEventListener( \"message\", e => {\n\n        if ( !( e.data && e.data.args && e.data.type === \"agent-response\" ) ) { return; }\n        var received = { origin: e.origin, data: e.data };\n        bus.emit( \"agent-response\", received );\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/emitters/browser/agent.js","export default function ajaxFormSubmit( ns ) {\n\n    const { bus } = ns;\n\n    function ajaxSubmit( form ) {\n\n        const doc = {};\n        [].slice.call( form.elements, 0 ).forEach( field => {\n\n            const name = field.name;\n            if ( name ) {\n\n                const values = doc[ name ] = doc[ name ] || [];\n                values.push( field.value );\n\n             }\n\n        } );\n        const url = form.action || window.location.toString();\n        const options = {\n\n            method: \"POST\",\n            body: JSON.stringify( doc ),\n            headers: { \"Accept\": \"application/json\", \"Content-Type\": \"application/json\" }\n\n        };\n        window.fetch( url, options ).then( response => {\n\n            if ( response.ok) {\n\n                var redirectedToHTML = !!~response.headers.get( \"content-type\" ).indexOf( \"text/html\" );\n                if ( redirectedToHTML ) {\n\n                    window.location.href = response.url;\n\n                } else {\n\n                    return response.json().then( json => bus.emit( \"fetch-result\", json ) );\n\n                }\n\n            } else {\n\n                return response.text().then( text => {\n\n                   throw new Error( \"Fetch failed with \" + response.status + \": \" + text );\n\n                }, e => {\n\n                    throw new Error( \"Fetch failed with \" + response.status + \": \" + e.message );\n\n                } );\n\n            }\n\n        } )\n        .catch( e => bus.emit( \"error-message\", e.message ) );\n\n    }\n\n    document.addEventListener( \"submit\", e => {\n\n        if ( !e.target.classList.contains( \"via-ajax\" ) ) { return; }\n        e.preventDefault();\n        ajaxSubmit( e.target );\n\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/ajax-form-submit.js","export default function embeddedBrowser( ns ) {\n\n    const { bus } = ns;\n\n    document.addEventListener( \"submit\", function( e ) {\n\n        if ( e.target.id === \"embedded-browser-controls\" ) {\n\n            e.preventDefault();\n            e.stopPropagation();\n            var url = e.target.location.value;\n            document.querySelector( \"#embedded-browser\" ).src = url;\n\n        }\n\n    } );\n\n    bus.on( \"navigate-to\", url => {\n\n        var frame = document.querySelector( \"#embedded-browser\" );\n        var isActive = true;\n        var giveup = setTimeout( function() {\n\n            if ( !isActive ) { return; }\n            isActive = false;\n            frame.removeEventListener( \"load\", waiter );\n            bus.emit( \"navigate-to-complete\", { url, err: new Error( \"Timed out\" ) } );\n\n        }, 10000 );\n\n        function waiter() {\n\n            if ( !isActive ) { return; }\n            frame.removeEventListener( 'load', waiter );\n            clearTimeout( giveup );\n            bus.emit( \"navigate-to-complete\", { url } );\n\n        }\n        frame.addEventListener('load', waiter);\n        frame.setAttribute( \"src\", url );\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/embedded-browser-widget.js","export default function( ns ) {\n\n    const { bus } = ns;\n    window.addEventListener( \"DOMContentLoaded\", () => {\n\n        if ( !document.body.classList.contains( \"path-page\" ) ) { return; }\n        bus.on( \"fetch-result\", detail => bus.emit( \"run-path\", detail ) );\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/path-page.js","export default function( ns ) {\n\n    const { bus, error } = ns;\n\n    let paths;\n    bus.on( \"run-script\", function( script ) {\n\n        const { pathScripts } = script;\n        var transcript = document.querySelector( \".script-transcript\" );\n        paths = pathScripts.pathIds.map( pathId => {\n\n            const path = pathScripts.paths[ pathId ];\n            var pathElement = document.createElement( \"li\" );\n            pathElement.innerHTML = path.name;\n            transcript.appendChild( pathElement );\n            return pathElement;\n\n        } );\n\n    } );\n\n    bus.on( \"script-complete\", function( detail ) {\n\n        const { nextIterationURL } = detail.script;\n        const stopper = document.querySelector( \"#stop\" );\n        if ( !stopper.checked ) {\n\n            window.location.replace( nextIterationURL );\n\n        } else {\n\n            document.body.classList.add( \"paused\" );\n\n        }\n\n    } );\n\n    let steps;\n    bus.on( \"run-path\", detail => {\n\n        const { pathId, paths } = detail;\n        const { stepScripts } = paths[ pathId ];\n        const transcript = document.querySelector( \".path-transcript\" );\n        const outcome = document.querySelector( \".path-outcome\" ) || {};\n        outcome.innerHTML = \"Running...\";\n        transcript.innerHTML = \"\";\n        steps = stepScripts.map( x => {\n\n            var s = document.createElement( \"li\" );\n            s.innerHTML = x.description;\n            transcript.appendChild( s );\n            return s;\n\n        } );\n\n    } );\n\n    bus.on( \"path-complete\", detail => {\n\n        const { errorSteps } = detail.path;\n        const { path } = detail.script || {};\n        const isError = errorSteps && errorSteps.length;\n        const scriptOutcome = document.querySelector( \".script-outcome\" ) || {};\n        const outcome = document.querySelector( \".path-outcome\" ) || {};\n        const errors = ( errorSteps || [] ).map( x => x.err );\n        outcome.innerHTML = [ \"Complete.\" ].concat( errors ).join( \"<br />\" );\n\n        if ( isError ) { error( errors.join( \"<br />\" ) ); }\n        if ( path && paths && paths.length ) {\n\n            const pathElement = paths[ path - 1 ];\n            pathElement.classList.remove( \"running\" );\n            scriptOutcome.innerHTML = \"Complete.\";\n            pathElement.classList.add( isError ? \"error\" : \"success\" );\n\n        }\n\n    } );\n\n\n    bus.on( \"run-step\", detail => {\n\n        const outcome = document.querySelector( \".step-outcome\" ) || {};\n        outcome.innerHTML = \"Running...\";\n        if ( steps && steps.length ) {\n\n            const pathContext = detail.context.path;\n            steps[ pathContext.step - 1 ].classList.add( \"running\" );\n\n        }\n\n    } );\n\n    bus.on( \"step-complete\", detail => {\n\n        const { err } = detail.step;\n        const step = detail.path ? detail.path.step : \"\";\n        const outcome = document.querySelector( \".step-outcome\" ) || {};\n        if ( steps && steps.length ) {\n\n            const stepElement = steps[ step - 1 ];\n            stepElement.classList.remove( \"running\" );\n            if ( err ) {\n\n                stepElement.classList.add( \"error\" );\n                outcome.innerHTML += `Step ${step}: ${err}\\n`;\n\n            } else {\n\n                stepElement.classList.add( \"success\" );\n\n            }\n\n        } else {\n\n            outcome.innerHTML = `Complete. ${err || \"\"}`;\n\n        }\n\n    } );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/runners.js","export default function( ns ) {\n\n    const { bus } = ns;\n    bus.on( \"initiate-script\", script => bus.emit( \"run-script\", script ) );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/script-run-page.js","export default function( ns ) {\n\n    const { bus } = ns;\n\n    window.addEventListener( \"DOMContentLoaded\", () => {\n\n        if( !document.body.classList.contains( \"step-page\" ) ) { return; }\n        ns.options.debug = true;\n\n        bus.on( \"fetch-result\", detail => {\n\n            document.querySelector( \"#code\" ).innerHTML = detail.script;\n            bus.emit( \"run-step\", detail );\n\n        } );\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/browser/step-page.js","export default function( ns ) {\n\n    const { bus, error } = ns;\n    bus.on( \"agent-request\", detail => {\n\n        var frame = document.querySelector( \"#embedded-browser\" );\n        if ( !frame ) { error( \"No embedded browser found\" ); }\n        frame.contentWindow.postMessage( detail, \"*\" );\n\n    } );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/listeners/browser/agent.js","export default function( ns ) {\n\n    const { bus } = ns;\n    bus.on( \"metrics\", metrics => {\n\n        window.navigator.sendBeacon( \"/metrics\", metrics );\n\n    } );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/listeners/browser/metrics-sink.js","function displayNotification( message, isError ) {\n\n    const infoBlock = document.createElement( \"li\" );\n    const timeBlock = document.createElement( \"time\" );\n    const messageBlock = document.createElement( \"div\" );\n\n    messageBlock.innerHTML = message;\n    timeBlock.innerHTML = new Date().toLocaleDateString();\n    infoBlock.className = isError ? \"error\" : \"\";\n    infoBlock.appendChild( timeBlock );\n    infoBlock.appendChild( messageBlock );\n    infoBlock.classList.add( \"goes\" );\n    document.querySelector( \".infos\" ).appendChild( infoBlock );\n    setTimeout( () => {\n\n        infoBlock.classList.add( \"going\" );\n        setTimeout( () => infoBlock.remove(), 500 );\n\n    }, 5000 );\n\n}\n\nfunction displayErrorNotification( message ) {\n\n    displayNotification( message.stack || message, true );\n\n}\n\nexport default function( ns ) {\n\n    const { bus } = ns;\n    bus.on( \"error-message\", displayErrorNotification );\n    bus.on( \"info-message\", displayNotification );\n    bus.on( \"debug-message\", displayNotification );\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/listeners/browser/notifications.js","import \"./browser-polyfills\";\nimport \"./browser-enhancements\";\n\nimport app from \"./app\";\n\nimport agentEmitters from \"./emitters/browser/agent\";\n\nimport ajaxFormSubmit from \"./enrichers/browser/ajax-form-submit\";\nimport embeddedBrowserWidget from \"./enrichers/browser/embedded-browser-widget\";\n\nimport runners from \"./enrichers/browser/runners\";\n\nimport stepPage from \"./enrichers/browser/step-page\";\nimport pathPage from \"./enrichers/browser/path-page\";\nimport scriptRunPage from \"./enrichers/browser/script-run-page\";\n\nimport agentListeners from \"./listeners/browser/agent\";\nimport notifications from \"./listeners/browser/notifications\";\nimport metricsSink from \"./listeners/browser/metrics-sink\";\n\nconst ns = window.formicido = window.formicido || {};\n\n[\n    app, // must be first\n\n    notifications, // user-display notifications\n    metricsSink, // relay metrics to the server\n\n    ajaxFormSubmit, // ajaxify form submission\n\n    agentEmitters, // marshall messages from agent\n    agentListeners, // marshall messages to agent\n\n    embeddedBrowserWidget, // react to the embedded (iframe) browser control\n    runners, // log the results of running stuff\n\n    stepPage,\n    pathPage,\n    scriptRunPage\n\n].forEach( module => module( ns ) );\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/browser.js","export default function( ns ) {\n\n    const { bus } = ns;\n\n    // thanks: http://stackoverflow.com/a/18391400/275501\n    function replaceErrors(key, value) {\n\n        if (value instanceof Error) {\n            var error = {};\n\n            Object.getOwnPropertyNames(value).forEach(function (key) {\n                error[key] = value[key];\n            });\n            return error;\n\n        }\n        return value;\n\n    }\n\n    const recordMetric = type => detail => {\n\n        detail = JSON.parse( JSON.stringify( detail, replaceErrors ) );\n        bus.emit( \"metrics\", JSON.stringify( { type, detail } ) );\n\n    };\n\n    bus.on( \"step-complete\", recordMetric( \"step\" ) );\n    bus.on( \"path-complete\", recordMetric( \"path\" ) );\n    bus.on( \"script-complete\", recordMetric( \"script\" ) );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/metrics-generator.js","export default function( ns ) {\n\n    const { bus, notify } = ns;\n    const aborted = {};\n    const instance = Math.random();\n\n    /*\n        runId: the id of the current run (e.g. a script run)\n        stepScripts: the steps to run for this path\n        compensations: the ids of paths to attempt to compensate for a failure (such as session timed out)\n        pathDetail: id of the path to run, and a dictionary of path definitions\n    */\n    function runPath( { runId, stepScripts, compensations, pathDetail } ) {\n\n        const { context, continuation } = pathDetail;\n        const { path } = context;\n\n        const compensationAttempts = pathDetail.compensations = pathDetail.compensations || {};\n\n        let bookmark = 0;\n\n        // run a single step within the current path\n        function nextStep( detail ) {\n\n            const isAborted = runId in aborted;\n            if ( isAborted ) { bus.emit( \"run-path-aborted\", context ); }\n            const err = detail ? detail.step.err : null;\n            if ( err ) {\n\n                // an error occurred - record diagnostics\n                path.errorSteps = path.errorSteps || [];\n                detail.step.errStack = err.stack;\n                path.errorSteps.push( detail.step );\n\n            }\n            if ( !err && bookmark < stepScripts.length && !isAborted ) {\n\n                // no error and step completed, so we can move on to the next one\n                bus.once( \"step-complete\", nextStep );\n                path.step = bookmark + 1;\n                const message = { context, ...stepScripts[ bookmark ] };\n                bookmark++;\n                bus.emit( \"run-step\", message );\n\n            } else {\n\n                path.end = Date.now();\n                let compensation = null;\n                if ( err && compensations ) {\n\n                    // can we compensate for this error?\n                    const unattempted = compensations.filter( x => !( x in compensationAttempts ) );\n                    compensation = unattempted[ 0 ];\n\n                }\n                if ( compensation ) {\n\n                    notify( \"Attempting compensation: \" + compensation );\n                    const continuation = compensationContext => {\n\n                        compensationAttempts[ compensation ] = JSON.parse( JSON.stringify( compensationContext ) );\n                        bus.emit( \"run-path\", pathDetail );\n\n                    };\n                    const compensationPathDetail = Object.assign( {}, pathDetail, { continuation, pathId: compensation } );\n                    bus.emit( \"run-path\", compensationPathDetail );\n\n                } else {\n\n                    if ( continuation ) {\n\n                        // this path was instructed to invoke a continuation upon completion (e.g. because it was a compensation path)\n                        notify( \"Path with continuation run complete\" );\n                        continuation( context );\n\n                    } else {\n\n                        notify( \"Path run complete\" );\n                        delete context.step;\n                        context.path.compensations = pathDetail.compensations;\n                        bus.emit( \"path-complete\", context );\n\n                    }\n\n                }\n\n            }\n\n        }\n        path.start = Date.now();\n        nextStep();\n\n    }\n\n    bus.on( \"abort-run\", detail => {\n\n        notify( `path-runner ${instance} received abort-run ${detail}` );\n        aborted[ detail.id ] = Date.now();\n        setTimeout( () => delete aborted[ detail.id ], 60000 );\n\n    } );\n\n\n    bus.on( \"run-path\", pathDetail => {\n\n        const { pathId, paths } = pathDetail;\n        const { stepScripts, name, compensations } = paths[ pathId ] || {};\n        if ( !( stepScripts && stepScripts.length ) ) {\n\n            notify( \"No steps specified\" );\n\n        }\n\n        const context = pathDetail.context = pathDetail.context || {};\n        const { runId } = context.script || {};\n        context.path = { name, pathId };\n        runPath( {\n\n            compensations,\n            pathDetail,\n            runId,\n            stepScripts\n\n        } );\n\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/path-runner.js","export default function( ns ) {\n\n    const { bus, notify } = ns;\n    const aborted = {};\n    const instance = Math.random();\n\n    bus.on( \"abort-run\", detail => {\n\n        notify( `script-runner ${instance} received abort-run ${detail}` );\n        aborted[ detail.id ] = Date.now();\n        setTimeout( () => delete aborted[ detail.id ], 60000 );\n\n    } );\n\n    bus.on( \"run-script\", script => {\n\n        let bookmark = 0;\n        const { pathScripts, nextIterationURL, runId, name } = script;\n        const { pathIds, paths } = pathScripts;\n        const scriptId = script.id;\n        const context = { script: { scriptId, name, nextIterationURL, runId } };\n\n        function nextPath() {\n\n            const isAborted = runId in aborted;\n            if ( isAborted ) { bus.emit( \"run-script-aborted\", context ); }\n            if ( bookmark < pathIds.length && !isAborted ) {\n\n                context.script.path = bookmark + 1;\n                bus.emit( \"run-path\", { context, pathId: pathIds[ bookmark ], paths } );\n                bookmark++;\n\n            } else {\n\n                bus.removeListener( \"path-complete\", pathComplete );\n                context.script.end = Date.now();\n                delete context.path;\n                bus.emit( \"script-complete\", context );\n                notify( \"Script run complete\" );\n\n            }\n\n        }\n\n        function pathComplete( detail ) {\n\n            const { pathId, start, errorSteps } = detail.path;\n            if ( errorSteps ) {\n\n                context.script.errorPaths = context.script.errorPaths || [];\n                context.script.errorPaths.push( { pathId, start, errorSteps } );\n\n            }\n            setTimeout( nextPath, 1000 );\n\n        }\n\n        if ( pathIds.length < 1 ) {\n\n            notify( \"No paths to run\" );\n\n        } else {\n\n            context.script.start = Date.now();\n            bus.on( \"path-complete\", pathComplete );\n            nextPath();\n\n        }\n\n    } );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/script-runner.js","import promiseTimeout from \"../promise-timeout\";\n\nexport default function runner( ns ) {\n\n    const { bus, uuid, debug } = ns;\n\n    function buildRemoteListener( cid, resolve, reject ) {\n\n        return received => {\n\n            if ( !( received && received.data && received.data.cid === cid ) ) { return; }\n            debug( \"Reply to: \" + cid );\n            const data = received.data;\n            const args = [].concat( data.args || [] );\n            const output = args.length === 1 ? args[ 0 ] : args;\n            if ( data.isSuccess ) {\n\n                resolve( output );\n\n            } else {\n\n                reject( output );\n\n            }\n\n        };\n\n    }\n\n    const functionScraper = /[^{]*{([\\s\\S]*)}$/;\n\n    function scrapeJS( maybeFunction ) {\n\n        return ( typeof maybeFunction === \"function\" )\n            ? functionScraper.exec( maybeFunction.toString() )[ 1 ]\n            : maybeFunction;\n\n    }\n\n    function remote( js, timeout ) {\n\n        js = scrapeJS( js );\n        const cid = uuid();\n        let listener;\n        return promiseTimeout( timeout || 5000, ( resolve, reject ) => {\n\n            listener = buildRemoteListener( cid, resolve, reject );\n\n            bus.on( \"agent-response\", listener );\n            debug( \"Remoting: \" + cid );\n            bus.emit( \"agent-request\", { cid, js } );\n\n        }, () => {\n\n            bus.removeListener( \"agent-response\", listener );\n\n        } );\n\n    }\n\n    function buildPollTask( testScript, interval, resolve, timeoutTest ) {\n\n        const pollTask = () => testScript()\n            .catch( err => { console.log( err ); return false; } )\n            .then( result => {\n\n                if ( result ) {\n\n                    resolve();\n\n                } else {\n\n                    if ( !timeoutTest() ) {\n\n                        debug( \"Scheduling another poll\" );\n                        setTimeout( pollTask, interval );\n\n                    }\n\n                }\n\n            } );\n        return pollTask;\n\n    }\n\n    function poll( interval, timeout, testScript ) {\n\n        var isTimedOut = false;\n        return promiseTimeout( timeout, ( resolve, reject ) => {\n\n            const pollTask = buildPollTask( testScript, interval, resolve, () => isTimedOut );\n            pollTask();\n\n        }, () => {\n\n            isTimedOut = true;\n\n        } );\n\n    }\n\n    function navigateTo( url ) {\n\n        return new Promise( ( resolve, reject ) => {\n\n            bus.once( \"navigate-to-complete\", detail => detail.err ? reject( detail.err ) : resolve() );\n            bus.emit( \"navigate-to\", url );\n\n        } );\n\n    }\n\n    bus.on( \"run-step\", function executeStep( detail ) {\n\n        const { id, description, script, args, constants } = detail;\n        let context = detail.context || {};\n        const stepId = id;\n        const parameterHash = Object.assign( { navigateTo, poll, remote }, constants, args );\n        const functionParameterNames = Object.keys( parameterHash );\n        const functionParameterValues = functionParameterNames.map( x => parameterHash[ x ] );\n        const func = Function.apply( null,  functionParameterNames.concat( script ) );\n\n        context.step = {\n\n            args,\n            description,\n            stepId\n\n        };\n        promiseTimeout( 10000, ( resolve, reject ) => {\n\n            context.step.start = Date.now();\n            func.apply( null, functionParameterValues ).then( resolve, reject );\n\n        }, maybeErr => {\n\n            context.step.end = Date.now();\n            context.step.err = maybeErr;\n            bus.emit( \"step-complete\", context );\n\n        } );\n\n    } );\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/client/enrichers/step-runner.js","export default function promiseTimeout( timeout, promise, callback ) {\n\n    const constructionStack = new Error().stack;\n    return new Promise( ( resolve, reject ) => {\n\n        let isActive = true;\n        function deactivate( err ) {\n\n            if ( !isActive ) { return false; }\n            isActive = false;\n            callback( err );\n            return true;\n\n        }\n\n        setTimeout( () => {\n\n            const timedOut = new Error( \"Timed out. \" + constructionStack );\n            if ( deactivate( timedOut ) ) {\n\n                reject( timedOut );\n\n            }\n\n        }, timeout );\n        promise( function() {\n\n            if ( deactivate() ) {\n\n                resolve.apply( null, arguments );\n\n            }\n\n        }, function( err ) {\n\n            if ( deactivate( err ) ) {\n\n                reject.apply( null, arguments );\n\n            }\n\n        } );\n\n    } );\n\n}\n\n\n// WEBPACK FOOTER //\n// ./src/client/promise-timeout.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/events/events.js\n// module id = 19\n// module chunks = 0"],"sourceRoot":""}